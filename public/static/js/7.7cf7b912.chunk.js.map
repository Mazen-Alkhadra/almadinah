{"version":3,"sources":["res/images/loading.gif","Data Stores/admin section/Grid Stores.js","Data Stores/admin section/Lookup Stores.js","res/images/wall1.jpg","res/Configs.js","res/Styles.js","helpers/datagridExporter.js","pages/admin section/Financial/Bills/BillRecords.js","pages/admin section/Financial/Reports/CustomerBalance.js"],"names":["generateParamsForRequest","loadOptions","isMoreOptions","params","i","JSON","stringify","slice","finCustomersSuppliersDataGrid","CustomStore","key","load","a","request","get","data","totalCount","allCount","summary","insert","values","post","update","customerId","remove","delete","finBillsDataGrid","financialPeriodId","billId","getRecords","finPaymentsDataGrid","paymentId","finCashDataGrid","cashEntryId","finCustomersSuppliersDataLookup","byKey","length","Configs","wall1Image","DECIMAL_NUM_FORMAT","e","htmlColumns","objectColumns","workbook","ExcelJS","Workbook","worksheet","addWorksheet","i18next","t","exportDataGrid","component","customizeCell","gridCell","excelCell","rowType","objCol","find","c","column","dataField","name","value","map","v","d","fieldName1","fieldName2","displayName","join","htmlToText","wordwrap","Date","toDateString","fill","type","pattern","fgColor","argb","font","italic","then","xlsx","writeBuffer","buffer","saveAs","Blob","cancel","withTranslation","props","cell","isReadOnly","dataGrid","createRef","useState","records","setRecords","loading","setLoading","getMaterialsUnitsForAllBills","updatedBills","updatedAddsDiscountsRecords","setValue","bills","addsDiscounts","b","total","unitPrice","quantity","discountRatio","discount","additionRatio","addition","netPrice","calculateNetPrice","TotalTotal","reduce","acc","r","useEffect","basic","padded","ref","dataSource","showBorders","showColumnLines","columnHidingEnabled","wordWrapEnabled","columnAutoWidth","allowColumnResizing","allowColumnReordering","loadPanel","indicatorSrc","LoadingGifImage","onSaved","items","current","instance","getDataSource","onEditorPreparing","parentType","editorOptions","disabled","onRowPrepared","rowElement","style","backgroundColor","color","fontWeight","rowIndex","mode","useIcons","allowUpdating","allowDeleting","allowAdding","caption","dataType","setCellValue","newData","oldData","format","visible","enabled","DS","store","RequireFetchData","customers","useTranslation","setData","error","setError","showBillDetails","setShowBillDetails","row","setRow","onShowBillDetails","onHideBillDetails","from","getTime","to","form","onGenerateClick","requset","calculateSelectedRow","options","summaryProcess","totalValue","title","colCount","formData","editorType","label","text","searchEnabled","valueExpr","displayExpr","showClearButton","primary","fluid","content","onClick","hoverStateEnabled","stateStoring","storageKey","onExporting","datagridExporter","sortIndex","sortOrder","allowClearing","hint","icon","calculateCustomSummary","summaryType","displayFormat","valueFormat","precision","showInColumn","onClose","open","closeIcon","header","size","centered","closeOnDimmerClick","maxHeight","overflow"],"mappings":"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","file":"static/js/7.7cf7b912.chunk.js","sourcesContent":["export default \"data:image/gif;base64,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\"","import CustomStore from 'devextreme/data/custom_store';\r\nimport request from '../../api';\r\n\r\n\r\nconst generateParamsForRequest = (loadOptions, isMoreOptions) => {\r\n    let params = '?';\r\n    for (let i in loadOptions) {\r\n        if (loadOptions[i])\r\n            params += `${i}=${JSON.stringify(loadOptions[i])}&`;\r\n    }\r\n    if (isMoreOptions)\r\n        return params;\r\n    return params = params.slice(0, -1);\r\n};\r\n\r\nexport const finCustomersSuppliersDataGrid = new CustomStore({\r\n    key: 'idCustomer',\r\n    load: async (loadOptions) => {\r\n        try {\r\n            const params = generateParamsForRequest(loadOptions);\r\n            const { data: { data, allCount: totalCount } } = await request.get(`/user/customer/fullinfo${params}`);\r\n            return { data, totalCount, summary: [totalCount] };\r\n        } catch (err) {\r\n            return err;\r\n        }\r\n    },\r\n    insert: async (values) => await request.post('/user/customer', values),\r\n    update: async (key, values) => await request.post('/user/customer/update', { ...values, customerId: key }),\r\n    remove: async (key) => await request.delete('/user/customer', { data: { customerId: key } })\r\n});\r\n\r\nexport const finPeriodsDataGrid = new CustomStore({\r\n    key: 'financialPeriodId',\r\n    load: async (loadOptions) => {\r\n        try {\r\n            const params = generateParamsForRequest(loadOptions);\r\n            const { data: { data, allCount: totalCount } } = await request.get(`/admin/aw/financial/periods/obbranch/${params}`);\r\n            return { data, totalCount };\r\n        } catch (err) {\r\n            return err;\r\n        }\r\n    },\r\n    insert: async (values) => await request.post('/admin/aw/financial/period', { ...values }),\r\n    update: async (key, values) => await request.post('/admin/aw/financial/period/update', { ...values, financialPeriodId: key }),\r\n    remove: async (key) => await request.delete('/admin/aw/financial/period', { data: { financialPeriodId: key } })\r\n});\r\n\r\nexport const finBillsDataGrid = new CustomStore({\r\n    key: 'billId',\r\n    load: async (loadOptions) => {\r\n        try {\r\n            const params = generateParamsForRequest(loadOptions, true);\r\n            const { data: { data, allCount: totalCount } } = await request.get(`/user/bill/fullinfo${params}`);\r\n            return { data, totalCount };\r\n        } catch (err) {\r\n            return err;\r\n        }\r\n    },\r\n    insert: async (values) => await request.post('/user/bill', values),\r\n    update: async (key, values) => await request.post('/user/bill/update', { ...values, billId: key }),\r\n    remove: async (key) => await request.delete('/user/bill', { data: { billId: key } })\r\n});\r\nfinBillsDataGrid.getRecords = async (billId) => await request.get(`/user/bill/${billId}/records`);\r\n\r\n\r\nexport const finPaymentsDataGrid = new CustomStore({\r\n    key: 'paymentId',\r\n    load: async (loadOptions) => {\r\n        try {\r\n            const params = generateParamsForRequest(loadOptions, true);\r\n            const { data: { data, allCount: totalCount, summary } } = await request.get(`/user/payment/fullinfo${params}`);\r\n            return { data, totalCount, summary };\r\n        } catch (err) {\r\n            return err;\r\n        }\r\n    },\r\n    insert: async (values) => await request.post('/user/payment', values),\r\n    update: async (key, values) => await request.post('/user/payment/update', { ...values, paymentId: key }),\r\n    remove: async (key) => await request.delete('/user/payment', { data: { paymentId: key } })\r\n});\r\n\r\nexport const finCashDataGrid = new CustomStore({\r\n    key: 'cashEntryId',\r\n    load: async (loadOptions) => {\r\n        try {\r\n            const params = generateParamsForRequest(loadOptions, true);\r\n            const { data: { data, allCount: totalCount, summary } } = await request.get(`/user/cash-entries/fullinfo${params}`);\r\n            return { data, totalCount, summary };\r\n        } catch (err) {\r\n            return err;\r\n        }\r\n    },\r\n    insert: async (values) => await request.post('/user/cash-entry', values),\r\n    update: async (key, values) => await request.post('/user/cash-entry/update', { ...values, cashEntryId: key }),\r\n    remove: async (key) => await request.delete('/user/cash-entry', { data: { cashEntryId: key } })\r\n});","import CustomStore from 'devextreme/data/custom_store';\r\nimport request from '../../api';\r\n\r\nconst generateParamsForRequest = (loadOptions, isMoreOptions) => {\r\n    let params = '?';\r\n    for (let i in loadOptions) {\r\n        if (loadOptions[i])\r\n            params += `${i}=${JSON.stringify(loadOptions[i])}&`;\r\n    }\r\n    if (isMoreOptions)\r\n        return params;\r\n    return params = params.slice(0, -1);\r\n};\r\n\r\n\r\nexport const finCustomersSuppliersDataLookup = new CustomStore({\r\n    key: 'idCustomer',\r\n    byKey: async (key) => { },\r\n    load: async (loadOptions) => {\r\n        try {\r\n            const params = generateParamsForRequest(loadOptions);\r\n            const { data: { data } } = await request.get(`/user/customer/fullinfo${params}`);\r\n            return { data, totalCount: data.length };\r\n        } catch (err) {\r\n            return err;\r\n        }\r\n    },\r\n});\r\n\r\n\r\n","export default __webpack_public_path__ + \"static/media/wall1.7a23f64d.jpg\";","export const Configs = {\r\n    DECIMAL_NUM_FORMAT: '#0.#####'\r\n}","import wall1Image from './images/wall1.jpg';\r\n\r\nexport const Styles = {\r\n    blockquoteUp: {\r\n        position: 'absolute',\r\n        fontSize: 150,\r\n        color: '#21BA45',\r\n        fontFamily: 'Georgia',\r\n        opacity: 0.5,\r\n        left: 0,\r\n    },\r\n    blockquoteDown: {\r\n        position: 'absolute',\r\n        fontSize: 150,\r\n        right: 0,\r\n        bottom: -30,\r\n        color: '#21BA45',\r\n        fontFamily: 'Georgia',\r\n        opacity: 0.3\r\n    },\r\n    background: {\r\n        backgroundImage: `url(${wall1Image})`,\r\n        backgroundPosition: 'center',\r\n        backgroundSize: 'cover',\r\n        backgroundRepeat: 'no-repeat',\r\n        margin: 0,\r\n        padding: 0,\r\n        paddingTop: 50,\r\n        paddingBottom: 50\r\n    },\r\n    noExtraSpaces: {\r\n        padding: 0,\r\n        margin: 1\r\n    }\r\n};","import { exportDataGrid } from 'devextreme/exporter/exceljs/export_data_grid';\r\nimport { htmlToText } from 'html-to-text';\r\nimport i18next from 'i18next';\r\nimport saveAs from 'file-saver';\r\nimport ExcelJS from 'exceljs';\r\n\r\nexport default (e, htmlColumns = [], objectColumns = []) => {\r\n    const workbook = new ExcelJS.Workbook();\r\n    const worksheet = workbook.addWorksheet(i18next.t('DataGrid'));\r\n\r\n    exportDataGrid({\r\n        component: e.component,\r\n        worksheet: worksheet,\r\n        customizeCell: ({ gridCell, excelCell }) => {\r\n\r\n            if (gridCell.rowType === 'data') {\r\n                const objCol = objectColumns.find(c => gridCell.column.dataField === c.name);\r\n                if (objCol && gridCell.value) {\r\n                    excelCell.value = gridCell.value.map(v => {\r\n                        const res = objCol.data.find(d => d[objCol.fieldName1] === v[objCol.fieldName2]);\r\n                        return res[objCol.displayName];\r\n                    }).join();\r\n                }\r\n\r\n                if (htmlColumns.find(c => gridCell.column.dataField === c)) {\r\n                    excelCell.value = htmlToText(gridCell.value, { wordwrap: null });\r\n                }\r\n\r\n                if (gridCell.column.dataField === 'creatAt') {\r\n                    excelCell.value = new Date(gridCell.value).toDateString();\r\n                }\r\n                if (gridCell.column.dataField === 'isActive') {\r\n                    excelCell.value = gridCell.value ? i18next.t('YES') : i18next.t('NO');\r\n                }\r\n            }\r\n            if (gridCell.rowType === 'group') {\r\n                excelCell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'BEDFE6' } };\r\n            }\r\n            if (gridCell.rowType === 'totalFooter' && excelCell.value) {\r\n                excelCell.font.italic = true;\r\n            }\r\n        }\r\n    }).then(() => {\r\n        workbook.xlsx.writeBuffer().then((buffer) => {\r\n            saveAs(new Blob([buffer], { type: 'application/octet-stream' }), 'DataGrid.xlsx');\r\n        });\r\n    });\r\n    e.cancel = true;\r\n};","import React, { useState, useEffect, createRef } from 'react';\r\nimport { Segment } from 'semantic-ui-react';\r\nimport DataGrid, { Column, Editing, Scrolling, Sorting, RequiredRule, Export } from 'devextreme-react/data-grid';\r\nimport { withTranslation } from 'react-i18next';\r\nimport { finBillsDataGrid } from '../../../../Data Stores';\r\nimport LoadingGifImage from '../../../../res/images/loading.gif';\r\nimport { Configs } from '../../../../res';\r\n\r\n\r\n\r\n\r\nconst Records = (props) => {\r\n    const { t, cell, isReadOnly } = props;\r\n    const billId = cell?.data?.billId || cell.billId;\r\n    const dataGrid = createRef();\r\n    const [records, setRecords] = useState(isReadOnly ? null : (cell.value || []));\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const getRecords = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const { data: { data } } = await finBillsDataGrid.getRecords(billId);\r\n            const { updatedBills, updatedAddsDiscountsRecords } = getMaterialsUnitsForAllBills(data, []);\r\n            setRecords(updatedBills);\r\n            !isReadOnly && cell.setValue && cell.setValue(updatedBills.length ? { updatedBills, updatedAddsDiscountsRecords } : null);\r\n        } catch (err) {\r\n            return err;\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const getMaterialsUnitsForAllBills = (bills, addsDiscounts) => {\r\n        const updatedBills = bills.map((b) => {\r\n            const total = b.unitPrice * b.quantity;\r\n            const discountRatio = b.discount ? (b.discount / total) : null;\r\n            const additionRatio = b.addition ? (b.addition / total) : null;\r\n            const netPrice = calculateNetPrice({ ...b, total, discountRatio, additionRatio });\r\n\r\n            return {\r\n                ...b,\r\n                total,\r\n                discountRatio,\r\n                additionRatio,\r\n                netPrice,\r\n            };\r\n        });\r\n\r\n        const TotalTotal = updatedBills.reduce((acc, r) => acc + r.total, 0);\r\n\r\n        const updatedAddsDiscountsRecords = addsDiscounts.map(r => {\r\n            const discountRatio = r.discount ? (r.discount / TotalTotal) : null;\r\n            const additionRatio = r.addition ? (r.addition / TotalTotal) : null;\r\n            return {\r\n                ...r,\r\n                discountRatio,\r\n                additionRatio,\r\n            };\r\n        });\r\n\r\n\r\n        return { updatedBills, updatedAddsDiscountsRecords };\r\n\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (isReadOnly ? null : cell.value) return;\r\n        if (billId) {\r\n            getRecords();\r\n        }\r\n        //eslint-disable-next-line\r\n    }, []);\r\n\r\n    const onSaved = () => {\r\n        let gridInstance = dataGrid.current.instance;\r\n        let items = gridInstance.getDataSource().items();\r\n        cell.setValue && cell.setValue({ updatedBills: items, updatedAddsDiscountsRecords: [] });\r\n        return true;\r\n    };\r\n\r\n\r\n\r\n    const calculateNetPrice = (data) => {\r\n        return (data.quantity * data.unitPrice) - (data.discount || 0) + (data.addition || 0);\r\n    };\r\n\r\n    if (loading) return <Segment basic padded loading={loading} />;\r\n\r\n    return (\r\n        <DataGrid\r\n            ref={dataGrid}\r\n            dataSource={records}\r\n            showBorders\r\n            showColumnLines\r\n            columnHidingEnabled\r\n            wordWrapEnabled\r\n            columnAutoWidth\r\n            allowColumnResizing\r\n            allowColumnReordering\r\n            loadPanel={{ indicatorSrc: LoadingGifImage }}\r\n            onSaved={onSaved}\r\n            onEditorPreparing={(e) => {\r\n                if (e.parentType === \"dataRow\" && (e.dataField === \"total\" || e.dataField === \"netPrice\")) {\r\n                    e.editorOptions.disabled = true;\r\n                }\r\n            }}\r\n\r\n            onRowPrepared={(e) => {\r\n                if (e.rowType === \"header\") {\r\n                    e.rowElement.style.backgroundColor = \"rgba(55,20,33,0.3)\";\r\n                    e.rowElement.style.color = 'brown';\r\n                    e.rowElement.style.fontWeight = 'bold';\r\n                }\r\n                if (e.rowType === \"data\" && e.rowIndex % 2 !== 0) {\r\n                    e.rowElement.style.backgroundColor = \"rgba(55,200,33,0.3)\";\r\n                }\r\n            }}\r\n\r\n        >\r\n            <Sorting mode='multiple' />\r\n            <Scrolling mode=\"infinity\" />\r\n            {!isReadOnly && <Editing\r\n                mode='batch'\r\n                useIcons\r\n                allowUpdating\r\n                allowDeleting\r\n                allowAdding\r\n            />}\r\n\r\n            <Column dataField=\"notice\" caption={t('Notice')} />\r\n\r\n            <Column dataField=\"quantity\" dataType=\"number\" caption={t('Quantity')}\r\n                setCellValue={(newData, value, oldData) => {\r\n                    newData.quantity = value > 0 ? value : 1;\r\n                    newData.unitPrice = 0;\r\n                    newData.total = newData.unitPrice * newData.quantity;\r\n                    if (oldData.additionRatio)\r\n                        newData.addition = oldData.additionRatio * newData.total;\r\n                    if (oldData.discountRatio)\r\n                        newData.discount = oldData.discountRatio * newData.total;\r\n                    newData.netPrice = calculateNetPrice({ ...oldData, ...newData });\r\n\r\n                }} >\r\n                <RequiredRule />\r\n            </Column>\r\n\r\n\r\n            <Column dataField=\"unitPrice\" caption={t('Price')} dataType='number' format={Configs.DECIMAL_NUM_FORMAT} setCellValue={(newData, value, oldData) => {\r\n                newData.unitPrice = value >= 0 ? value : 0;\r\n                newData.total = newData.unitPrice * oldData.quantity;\r\n                if (oldData.additionRatio)\r\n                    newData.addition = oldData.additionRatio * newData.total;\r\n                if (oldData.discountRatio)\r\n                    newData.discount = oldData.discountRatio * newData.total;\r\n                newData.netPrice = calculateNetPrice({ ...oldData, ...newData });\r\n\r\n            }} >\r\n                <RequiredRule />\r\n            </Column>\r\n\r\n            <Column dataField=\"total\" dataType='number' caption={t('Total')} format={Configs.DECIMAL_NUM_FORMAT} />\r\n\r\n            <Column dataField=\"discount\" format={Configs.DECIMAL_NUM_FORMAT} dataType='number' caption={t('Discount')}\r\n                visible={false}\r\n                setCellValue={(newData, value, oldData) => {\r\n                    newData.discount = value >= 0 ? value : 0;\r\n                    newData.discountRatio = newData.discount / oldData.total;\r\n                    newData.netPrice = calculateNetPrice({ ...oldData, ...newData });\r\n                }}\r\n            />\r\n\r\n            <Column dataField=\"discountRatio\" dataType='number'\r\n                caption={t('DiscountRatio')}\r\n                format='percent'\r\n                visible={false}\r\n                setCellValue={(newData, value, oldData) => {\r\n                    newData.discountRatio = value >= 0 ? value / 100 : 0;\r\n                    newData.discount = newData.discountRatio * oldData.total;\r\n                    newData.netPrice = calculateNetPrice({ ...oldData, ...newData });\r\n                }} />\r\n\r\n            <Column dataField=\"addition\" dataType='number' format={Configs.DECIMAL_NUM_FORMAT} caption={t('Addition')}\r\n                visible={false}\r\n                setCellValue={(newData, value, oldData) => {\r\n                    newData.addition = value >= 0 ? value : 0;\r\n                    newData.additionRatio = newData.addition / oldData.total;\r\n                    newData.netPrice = calculateNetPrice({ ...oldData, ...newData });\r\n                }}\r\n            />\r\n\r\n            <Column dataField=\"additionRatio\" dataType='number'\r\n                visible={false}\r\n                caption={t('AdditionRatio')}\r\n                format='percent'\r\n                setCellValue={(newData, value, oldData) => {\r\n                    newData.additionRatio = value > 0 ? value / 100 : 1;\r\n                    newData.addition = newData.additionRatio * oldData.total;\r\n                    newData.netPrice = calculateNetPrice({ ...oldData, ...newData });\r\n                }}\r\n            />\r\n\r\n            <Column dataField=\"netPrice\" dataType='number' visible={false} format={Configs.DECIMAL_NUM_FORMAT} caption={t('NetPrice')} />\r\n\r\n            <Export enabled />\r\n        </DataGrid>\r\n    );\r\n};\r\n\r\nexport default withTranslation()(Records);\r\n","import React, { useState } from 'react';\r\nimport { Divider, Segment, Button, Modal } from 'semantic-ui-react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport Form, { Item } from 'devextreme-react/ui/form';\r\nimport DataGrid, { Button as DevButton, Column, Lookup, Export, FilterPanel, FilterRow, Scrolling, SearchPanel, Sorting, RequiredRule, Summary, TotalItem } from 'devextreme-react/data-grid';\r\nimport { finCustomersSuppliersDataLookup } from '../../../../Data Stores';\r\nimport { ErrorSegment, PageHeader } from '../../../../components';\r\nimport requset from '../../../../api';\r\nimport LoadingGifImage from '../../../../res/images/loading.gif';\r\nimport { Configs } from '../../../../res';\r\nimport datagridExporter from '../../../../helpers/datagridExporter';\r\nimport { RequireFetchData } from '../../../../middlewares/HOC';\r\nimport BillRecords from '../Bills/BillRecords';\r\n\r\nconst CustomerBalance = (props) => {\r\n    const { customers } = props;\r\n    const { t } = useTranslation();\r\n    const [data, setData] = useState(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n\r\n    const [showBillDetails, setShowBillDetails] = useState(false);\r\n    const [row, setRow] = useState([]);\r\n\r\n    const onShowBillDetails = (e) => {\r\n        setRow([e.row.data]);\r\n        setShowBillDetails(true);\r\n    };\r\n\r\n    const onHideBillDetails = () => {\r\n        setShowBillDetails(false);\r\n        setRow([]);\r\n    };\r\n\r\n    const [form] = useState({\r\n        customerId: null,\r\n        from: new Date(new Date().getTime() - (1000 * 60 * 60 * 24 * 10)),\r\n        to: new Date(),\r\n    });\r\n\r\n    const onGenerateClick = async (params) => {\r\n        setLoading(true);\r\n        setError('');\r\n        setData(null);\r\n        try {\r\n            const { data: { data } } = await requset.get(`/user/reports/customer-balance`, { params });\r\n            setData(data);\r\n        } catch (err) {\r\n            setError(err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const calculateSelectedRow = (options) => {\r\n        if (options.name === 'Summary') {\r\n            if (options.summaryProcess === 'start') {\r\n                options.totalValue = 0;\r\n            } else if (options.summaryProcess === 'calculate') {\r\n                if (options.value.billId)\r\n                    options.totalValue -= options.value.value;\r\n                else if (options.value.paymentId)\r\n                    options.totalValue += options.value.value;\r\n            }\r\n        }\r\n    };\r\n    const renderFilters = () => {\r\n        return (\r\n            <Segment basic>\r\n                <Form colCount={3} formData={form}>\r\n                    <Item dataField=\"customerId\" editorType=\"dxSelectBox\" label={{ text: t('Customer') }} editorOptions={{ items: customers, searchEnabled: true, valueExpr: 'idCustomer', displayExpr: \"fullName\", }} />\r\n                    <Item dataField=\"from\" editorType=\"dxDateBox\" label={{ text: t('From') }} editorOptions={{ showClearButton: true }} />\r\n                    <Item dataField=\"to\" editorType=\"dxDateBox\" label={{ text: t('To') }} editorOptions={{ showClearButton: true }} />\r\n                </Form>\r\n\r\n                <Divider />\r\n                <Button primary fluid content={t('Generate')} onClick={() => onGenerateClick(form)} loading={loading} />\r\n                <Divider />\r\n            </Segment>\r\n        );\r\n    };\r\n\r\n\r\n    const renderResult = () => {\r\n        if (error) return <ErrorSegment />;\r\n\r\n        if (data) {\r\n            return (\r\n                <Segment basic>\r\n                    <DataGrid\r\n                        dataSource={data}\r\n                        showBorders\r\n                        showColumnLines\r\n                        columnHidingEnabled\r\n                        wordWrapEnabled\r\n                        columnAutoWidth\r\n                        allowColumnResizing\r\n                        hoverStateEnabled\r\n                        allowColumnReordering\r\n                        stateStoring={{ enabled: true, type: 'localStorage', storageKey: 'BalanceDataGridConfigs' }}\r\n                        onExporting={datagridExporter}\r\n                        loadPanel={{ indicatorSrc: LoadingGifImage }}\r\n                        onRowPrepared={(e) => {\r\n                            if (e.rowType === \"header\") {\r\n                                e.rowElement.style.backgroundColor = \"rgba(55,20,33,0.3)\";\r\n                                e.rowElement.style.color = 'brown';\r\n                                e.rowElement.style.fontWeight = 'bold';\r\n                            }\r\n                            if (e.rowType === \"data\") {\r\n                                if (e.data.billId)\r\n                                    e.rowElement.style.backgroundColor = \"rgba(200,55,33,0.3)\";\r\n                                else if (e.data.paymentId)\r\n                                    e.rowElement.style.backgroundColor = \"rgba(55,200,33,0.3)\";\r\n                            }\r\n                        }}\r\n                    >\r\n                        <Sorting mode='multiple' />\r\n                        <Scrolling mode=\"infinity\" />\r\n                        <FilterRow visible />\r\n                        <FilterPanel visible />\r\n                        <SearchPanel visible />\r\n\r\n                        <Column dataField=\"at\" dataType=\"datetime\" caption={t('CreatedAt')} sortIndex={0} sortOrder='asc' />\r\n                        <Column dataField=\"customerId\" caption={t('Customer')}>\r\n                            <Lookup\r\n                                dataSource={customers}\r\n                                displayExpr=\"fullName\"\r\n                                valueExpr='idCustomer'\r\n                                allowClearing\r\n                            />\r\n                            <RequiredRule />\r\n                        </Column>\r\n                        <Column dataField=\"serialNumber\" caption={t('SerialNumber')} />\r\n                        <Column dataField=\"value\" caption={t('Value')} dataType='number' format={Configs.DECIMAL_NUM_FORMAT} />\r\n                        <Column dataField=\"notic\" caption={t('Notice')} />\r\n\r\n                        <Column type='buttons' caption={t('Actions')}>\r\n                            <DevButton hint={t('Records')} icon=\"copy\" onClick={onShowBillDetails} visible={(e) => e.row.data.billId} />\r\n                        </Column>\r\n\r\n                        <Summary calculateCustomSummary={calculateSelectedRow} >\r\n                            <TotalItem\r\n                                name=\"Summary\"\r\n                                summaryType=\"custom\"\r\n                                displayFormat={`${t('Balance')}: {0}`}\r\n                                valueFormat={{ precision: 2 }}\r\n                                showInColumn=\"value\" />\r\n                        </Summary>\r\n\r\n                        <Export enabled />\r\n\r\n                        <Modal\r\n                            onClose={onHideBillDetails}\r\n                            open={showBillDetails}\r\n                            content={row[0] && <Segment basic><BillRecords cell={row[0]} isReadOnly /></Segment>}\r\n                            closeIcon\r\n                            header={t('Records')}\r\n                            size='fullscreen'\r\n                            centered\r\n                            closeOnDimmerClick={false}\r\n                            style={{ maxHeight: '95vh', overflow: 'auto' }}\r\n                        />\r\n                    </DataGrid>\r\n                </Segment>\r\n            );\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Segment>\r\n            <PageHeader title={t('CustomerBalance')} />\r\n            {renderFilters()}\r\n            {renderResult()}\r\n        </Segment>\r\n    );\r\n};\r\n\r\nconst DS = [\r\n    {\r\n        store: finCustomersSuppliersDataLookup,\r\n        name: 'customers'\r\n    },\r\n];\r\n\r\nexport default RequireFetchData(CustomerBalance, DS);"],"sourceRoot":""}